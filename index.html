<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>BI Dashboard ‚Äì Ejecutivo & H√≠brido</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --primary: #003366;
            --accent: #007bff;
            --bg: #f0f2f5;
            --card-bg: #ffffff;
            --nav-height: 65px;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg);
            color: #333;
            display: flex;
            flex-direction: column;
            height: 100vh; /* Altura fija para evitar saltos */
            overflow: hidden;
        }

        /* ===== HEADER ===== */
        header {
            background: var(--primary);
            color: white;
            padding: 0.8rem 1.2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        header h1 { font-size: 1.1rem; margin: 0; }

        select#fechaSelect {
            background: white;
            padding: 6px 10px;
            border-radius: 6px;
            border: none;
            font-size: 0.85rem;
            font-weight: bold;
            max-width: 150px;
        }

        /* ===== CONTENIDO PRINCIPAL ===== */
        main {
            flex: 1;
            overflow-y: auto;
            position: relative;
            -webkit-overflow-scrolling: touch; /* Scroll suave en iOS */
        }

        .view {
            display: none;
            padding-bottom: var(--nav-height); /* Espacio para la nav inferior */
        }

        .view.active { display: block; }

        /* Mapa ocupa todo el viewport menos header y nav */
        #v-mapa { height: 100%; }
        #mapaFrame {
            width: 100%;
            height: calc(100vh - 120px); 
            border: none;
        }

        /* ===== SECCI√ìN RESUMEN ===== */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
        }

        .kpis-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 2 columnas en m√≥vil */
            gap: 12px;
            margin-bottom: 20px;
        }

        .kpi-card {
            background: var(--card-bg);
            padding: 15px 10px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            text-align: center;
            border-bottom: 3px solid var(--accent);
        }

        .kpi-card span { font-size: 0.7rem; color: #666; font-weight: bold; display: block; margin-bottom: 5px; }
        .kpi-card h2 { margin: 0; font-size: 1.4rem; color: var(--primary); }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr; /* 1 columna en m√≥vil */
            gap: 20px;
        }

        .chart-card {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        
        .chart-card h3 { font-size: 0.95rem; margin-top: 0; margin-bottom: 15px; color: var(--primary); }

        /* ===== NAVEGACI√ìN INFERIOR (ESTILO APP) ===== */
        .nav-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--nav-height);
            background: white;
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-top: 1px solid #ddd;
            padding-bottom: env(safe-area-inset-bottom); /* Soporte para iPhone notch */
            z-index: 2000;
        }

        .nav-btn {
            flex: 1;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: none;
            background: none;
            color: #777;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: 0.2s;
        }

        .nav-btn.active {
            color: var(--accent);
            background: #f0f7ff;
        }

        /* Indicador visual activo superior */
        .nav-btn.active::before {
            content: "";
            position: absolute;
            top: 0;
            width: 30%;
            height: 3px;
            background: var(--accent);
            border-radius: 0 0 4px 4px;
        }

        /* ===== MEDIA QUERIES PARA NOTEBOOK ===== */
        @media (min-width: 768px) {
            header h1 { font-size: 1.4rem; }
            header { padding: 1rem 2rem; }
            
            .kpis-grid {
                grid-template-columns: repeat(4, 1fr); /* 4 columnas en PC */
                gap: 20px;
            }

            .charts-grid {
                grid-template-columns: 1fr 1fr; /* 2 columnas en PC */
            }

            .kpi-card h2 { font-size: 1.8rem; }
            
            /* Ajuste de Nav para PC */
            .nav-bar {
                position: relative;
                height: 50px;
                border-top: none;
                justify-content: center;
                gap: 20px;
            }
            .nav-btn {
                flex: none;
                width: 150px;
                border-radius: 8px;
                height: 40px;
            }
            .nav-btn.active::before { display: none; }
            .nav-btn.active { border-radius: 20px; }
            
            .view { padding-bottom: 20px; }
        }
    </style>
</head>
<body>

<header>
    <h1>üìä DashCom v2.0</h1>
    <select id="fechaSelect" onchange="cambiarFecha(this.value)">
        <option value="">Fecha</option>
        <option value="2025-12-31">31/12/2025</option>
        <option value="2026-01-19">19/01/2026</option>
    </select>
</header>

<main>
    <div id="v-mapa" class="view active">
        <iframe id="mapaFrame" src=""></iframe>
    </div>

    <div id="v-resumen" class="view">
        <div class="container">
            <div class="kpis-grid">
                <div class="kpi-card">
                    <span>VENTAS TOTALES</span>
                    <h2 id="k-ventas">0</h2>
                </div>
                <div class="kpi-card">
                    <span>NODOS ACTIVOS</span>
                    <h2 id="k-nodos">0</h2>
                </div>
                <div class="kpi-card">
                    <span>SIN VENTA</span>
                    <h2 id="k-sin">0</h2>
                </div>
                <div class="kpi-card">
                    <span>COBERTURA</span>
                    <h2 id="k-pct">0%</h2>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <h3>Ventas por Zona</h3>
                    <canvas id="chartBar"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Distribuci√≥n Nodos</h3>
                    <canvas id="chartPie"></canvas>
                </div>
            </div>
        </div>
    </div>
</main>

<nav class="nav-bar">
    <button class="nav-btn active" onclick="showV('v-mapa', this)">üìç Mapa</button>
    <button class="nav-btn" onclick="showV('v-resumen', this)">üìä Resumen</button>
</nav>

<script>
    // Tu l√≥gica de JS se mantiene igual, solo aseg√∫rate de que el renderizado de ChartJS 
    // sea responsivo (ya est√° en tus opciones)
    let bChart, pChart;

    function showV(id, btn) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
        
        // Reset scroll position
        document.querySelector('main').scrollTop = 0;
    }

    // El resto de tus funciones (cambiarFecha, renderDash) permanecen intactas.
    // ... (Mant√©n tu c√≥digo de Chart.js aqu√≠)
</script>
</body>
</html>
